<script>
    jQuery('#fb5').data('config', {
        "page_width":"550",
        "page_height":"715",
        "email_form":"office@somedomain.com",
        "zoom_double_click":"1",
        "zoom_step":"0.06",
        "double_click_enabled":"true",
        "tooltip_visible":"true",
        "toolbar_visible":"true",
        "gotopage_width":"30",
        "deeplinking_enabled":"true",
        "rtl":"false",
        'full_area':'true',
        'lazy_loading_thumbs':'false',
        'lazy_loading_pages':'false'
    });

$(function () {
    // Функция для обновления классов `active` на страницах
    function updateActivePagesFromHash() {
        const hash = window.location.hash.slice(1); // Убираем символ `#`
        const pageMatch = hash.match(/page(\d+)-page(\d+)/); // Ищем формат "pageX-pageY"

        // Удаляем класс `active` со всех страниц
        $('.turn-page-wrapper').removeClass('active');

        if (pageMatch) {
            const page1 = pageMatch[1]; // Первая страница
            const page2 = pageMatch[2]; // Вторая страница

            // Добавляем класс `active` для найденных страниц
            $(`.turn-page-wrapper[page="${page1}"]`).addClass('active');
            $(`.turn-page-wrapper[page="${page2}"]`).addClass('active');

            console.log(`Активные страницы: ${page1}, ${page2}`);
        } else {
            console.warn("Не удалось найти страницы в адресной строке.");
        }
    }

    // Функция для удаления всех существующих подсказок
    function removeHints() {
        $('.introjs-hint').remove(); // Удаляем подсказки из DOM
        $('.introjs-tooltip').remove(); // Удаляем все активные тултипы
    }

    // Функция для создания подсказок вручную
    function createHints() {
        // Удаляем старые подсказки
        removeHints();

        // Находим все элементы с подсказками на активных страницах
        $('.turn-page-wrapper.active [data-hint]').each(function () {
            const $element = $(this);
            const hintText = $element.attr('data-hint');
            const hintPosition = $element.attr('data-hintposition') || 'bottom-middle';

            // Создаём подсказку вручную
            const hint = $(`<div class="introjs-hint" style="position: absolute;"></div>`);
            const hintDot = $('<div class="introjs-hint-dot"></div>');
            const hintPulse = $('<div class="introjs-hint-pulse"></div>');

            hint.append(hintDot).append(hintPulse);

            // Располагаем подсказку рядом с элементом
            const offset = $element.offset();
            hint.css({
                top: offset.top,
                left: offset.left,
            });

            // Добавляем событие на подсказку
            hint.on('click', function () {
                // Показываем тултип при клике
                const tooltip = $(`
                    <div class="introjs-tooltip" style="position: absolute;">
                        <div class="introjs-tooltiptext">${hintText}</div>
                        <button class="introjs-tooltipbutton">OK</button>
                    </div>
                `);

                // Расположение тултипа
                tooltip.css({
                    top: offset.top + 30, // Сдвиг вниз
                    left: offset.left, // Сдвиг влево
                });

                $('body').append(tooltip);

                // Удаление тултипа при нажатии на кнопку
                tooltip.find('.introjs-tooltipbutton').on('click', function () {
                    tooltip.remove();
                });
            });

            $('body').append(hint);
        });
    }

    // Функция для обработки изменения страницы
    function handlePageChange() {
        updateActivePagesFromHash(); // Обновляем классы `active` для страниц
        removeHints(); // Удаляем старые подсказки
        createHints(); // Создаём новые подсказки для активных страниц
    }

    // Слушатель изменений
    $(window).on("hashchange", function () {
        handlePageChange();
    });

    // Инициализация
    handlePageChange();
});

</script>